<!DOCTYPE html>
<html lang="no">
  <head>
    <meta charset="UTF-8" />
    <title>{{ title }}</title>
  </head>
  <body>
    <nav>
      <a href="/">Hjem</a> | <a href="/blog/">Blogg</a>
    </nav>
    <main>
      {{ content | safe }}
    </main>

    <!-- Netlify Identity widget -->
<!-- Netlify Identity widget -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
<script>
  (function () {
    function openModalForHash(h) {
      if (!h) return;
      if (h.includes('invite_token=')) {
        console.log('[Identity] invite_token registrert, åpner signup-modal');
        netlifyIdentity.open('signup');
      } else if (h.includes('recovery_token=')) {
        console.log('[Identity] recovery_token registrert, åpner login-modal');
        netlifyIdentity.open('login');
      }
    }

    if (window.netlifyIdentity) {
      netlifyIdentity.on('init', (user) => {
        console.log('[Identity] init, user:', user);
        openModalForHash(window.location.hash);
      });

      netlifyIdentity.on('error', (err) => {
        console.error('[Identity] error:', err);
      });

      // Etter login -> gå direkte til admin
      netlifyIdentity.on('login', () => {
        window.location.href = '/admin/';
      });

      netlifyIdentity.init();
    }
  })();
</script>

  </body>
</html>
